import org.apache.tools.ant.filters.ReplaceTokens

plugins {
    id "net.foragerr.jmeter" version "1.0.5-2.13"
}

apply plugin: 'java'
apply plugin: 'maven'


group = project.property("project.group")
version = project.property("project.version")

description = """"""

sourceCompatibility = 1.8
targetCompatibility = 1.8

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

sourceSets {
    main {
        resources {
            srcDirs "src/main/resources", "src/main/ci"
        }
    }
    test {
        resources {
            srcDirs "src/test/resources", "src/test/jmeter"
        }
    }
}

processResources {
    filter ReplaceTokens, tokens: [
            "project.version"   : project.property("project.version"),
            "project.group"     : project.property("project.group"),
            "project.artifactId": rootProject.name,
            "docker.registry.url": project.property("docker.registry.url")
    ]
}

processTestResources {
    filter ReplaceTokens, tokens: [
            "jmeter.remoteServiceHost": project.property("jmeter.remoteServiceHost"),
            "jmeter.renoteServiceHost": project.property("jmeter.remoteServicePort")
    ]
}

repositories {
    maven { url 'http://bootstrap.stratio.bawag.com:12555/repository/maven-central' }
    maven { url 'http://bootstrap.stratio.bawag.com:12555/repository/releases' }
    maven { url 'http://bootstrap.stratio.bawag.com:12555/repository/snapshots' }
}


dependencies {
    implementation 'com.stratio.architecture:stratio-microservices-parent:0.4.0'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'org.projectlombok:lombok'
    implementation 'commons-io:commons-io'
    implementation 'com.stratio.architecture.microservices:stratio-microservices-monitoring'
    implementation 'com.stratio.architecture.microservices:stratio-microservices-logging'
    implementation 'org.springframework.boot:spring-boot-starter-test'
    implementation 'info.cukes:cucumber-core'
    implementation 'info.cukes:cucumber-java'
    implementation 'info.cukes:cucumber-junit'
    implementation 'info.cukes:cucumber-spring'
}

task unitTest(type: Test) {
    exclude '**/integration/**'
}

task integrationTest(type: Test) {
    include '**/integration/**'
}
